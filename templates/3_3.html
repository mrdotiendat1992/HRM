{% extends  "base.html" %}
{% block style%}
<style>
label {
    width:150px;
    margin-left: 10px;
}
input, select {
    margin-left: 10px;
    width: 150px;
    readonly;
}
</style>
{% endblock style %}
{% block content %}
<div class="content">
    
    <div class="form-group">
        <label for="masothe">Mã số thẻ</label>
        {% if mst %}
        <input type="text" id="masothe" name="masothe" value="{{mst}}"  onchange="kiemtrathongtinnld()">
        {% else %}
        <input type="text" id="masothe" name="masothe"  onchange="kiemtrathongtinnld()">
        {% endif %}
    </div>

    <hr />
    <form method="post" action="/muc3_3">
        <div class="form-group">
            <label for="mst">Mã số thẻ</label>
            <input type="text" id="mst" name="mst" readonly>
            <label for="hoten">Họ tên</label>
            <input type="text" id="hoten" name="hoten" readonly>
            <label for="gioitinh">Giới tính</label>
            <input type="text" id="gioitinh" name="gioitinh" readonly>
        </div>

        <div class="form-group">
            <label for="ngaysinh">Ngày sinh</label>
            <input type="date" id="ngaysinh" name="ngaysinh" readonly>
            <label for="diachi">Địa chỉ</label>
            <input type="text" id="diachi" name="diachi" readonly>
            <label for="quoctich">Quốc tịch</label>
            <input type="text" id="quoctich" name="quoctich" readonly>
            
        </div>

        <div class="form-group">
            <label for="cccd">CCCD</label>
            <input type="text" id="cccd" name="cccd" readonly>
            <label for="ngaybatdau">Ngày bắt đầu</label>
            <input type="date" id="ngaybatdau" name="ngaybatdau" >
        </div>

        <div class="form-group">
            <label for="ngaycapcccd">Ngày cấp CCCD</label>
            <input type="date" id="ngaycapcccd" name="ngaycapcccd" readonly>
            <label for="ngayketthuc">Ngày kết thúc</label>
            <input type="date" id="ngayketthuc" name="ngayketthuc" >
        </div>

        <div class="form-group">
            <label for="loaihopdong">Loại hợp đồng</label>
            <input type="text" id="loaihopdong" name="loaihopdong" >
            <label for="chucvu">Chức vụ</label>
            <input type="text" id="chucvu" name="chucvu" >
            <label for="bophan">Phòng ban</label>
            <input type="text" id="bophan" name="bophan" >
        </div>

        <div class="form-group">
            <label for="luongcoban">Mức lương cơ bản</label>
            <input type="text" id="luongcoban" name="luongcoban" >
            <label for="phucap">Các loại phụ cấp</label>
            <input type="text" id="phucap" name="phucap" >
            <label for="tienphucap">Phụ cấp</label>
            <input type="text" id="tienphucap" name="tienphucap" >
        </div>

        <hr />
        <div class="form-group">
            <label for="kieuhopdong">Loại HĐ muốn in</label>
            <select id="kieuhopdong" name="kieuhopdong">
                <option value="HĐ thử việc">HĐ thử việc</option>
                <option value="HĐ xác định thời hạn lần 1">HĐ xác định thời hạn lần 1</option>
                <option value="HĐ xác định thời hạn lần 2">HĐ xác định thời hạn lần 2</option>
                <option value="HĐ vô thời hạn">HĐ vô thời hạn</option>
            </select>
            <input class="btn btn-primary" value="In hợp đồng" type="submit"></select>
        </div>
        

    <script>
       
        function kiemtrathongtinnld() {
            axios({
                method: 'post',
                url: '/kiemtrathongtinnld?masothe=' + document.getElementById("masothe").value
            })
                .then(function (response) {
                    var data = response.data
                    if (response.data != "") {
                        console.log(data)
                        document.getElementById("mst").value = data["MST"]; // 1
                        document.getElementById("ngaysinh").value = data["Ngày sinh"]; //2
                        document.getElementById("hoten").value = data["Họ tên"]; //3
                        document.getElementById("gioitinh").value = data["Giới tính"]; //4
                        document.getElementById("quoctich").value = data["Quốc tịch"]; //5
                        document.getElementById("cccd").value = data["CCCD"]; //6
                        document.getElementById("ngaycapcccd").value = data["Ngày cấp CCCD"]; //7
                        document.getElementById("diachi").value = data["Thường trú"]; //10
                        document.getElementById("ngaybatdau").value = data["Ngày ký HĐ"]; //11
                        document.getElementById("ngayketthuc").value = data["Ngày hết hạn"]; //12
                        document.getElementById("loaihopdong").value = data["Loại hợp đồng"]; //13
                        document.getElementById("chucvu").value = data["Chức vụ"]; //14
                        document.getElementById("luongcoban").value = data["Lương cơ bản"]; //15
                        document.getElementById("phucap").value = data["Phụ cấp"]; //16
                        document.getElementById("tienphucap").value = data["Tiền phụ cấp"]; //17
                        document.getElementById("bophan").value = data["Department"]; //17
                    }
                })
                .catch(function (error) {
                    console.log(error);
                });
        }
        // Function to format the number with commas as thousand separators
        function formatNumberWithCommas(number) {
            // Split the value into integer and decimal parts if there's a decimal point
            let parts = number.split('.');
            parts[0] = parts[0].replace(/\B(?=(\d{3})+(?!\d))/g, ",");
            return parts.join('.');
        }

        // Event listener for input field
        document.getElementById('luongcoban').addEventListener('input', function (e) {
            // Remove all characters except digits and decimal point
            let value = e.target.value.replace(/[^0-9.]/g, '');

            // Allow only one decimal point
            let decimalParts = value.split('.');
            if (decimalParts.length > 2) {
                value = decimalParts[0] + '.' + decimalParts.slice(1).join('');
            }

            // Format the number with commas
            let formattedValue = formatNumberWithCommas(value);

            // Set the formatted value back to the input field
            e.target.value = formattedValue;
        });

        // Event listener for input field
        document.getElementById('tienphucap').addEventListener('input', function (e) {
            // Remove all characters except digits and decimal point
            let value = e.target.value.replace(/[^0-9.]/g, '');

            // Allow only one decimal point
            let decimalParts = value.split('.');
            if (decimalParts.length > 2) {
                value = decimalParts[0] + '.' + decimalParts.slice(1).join('');
            }

            // Format the number with commas
            let formattedValue = formatNumberWithCommas(value);

            // Set the formatted value back to the input field
            e.target.value = formattedValue;
        });
    </script>
</div>
{% endblock content %}
