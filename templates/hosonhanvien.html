{% extends  "base.html" %}
{% block style%}
<style>
    /* Vertical Roadmap container */
    .vertical-roadmap {
        position: relative;
        margin: 20px 0;
        padding: 20px 0;
        width: 80%; /* Adjust the width as needed */
        margin: 0 auto; /* Center the roadmap */
    }
    
    /* Individual roadmap item */
    .roadmap-item {
        position: relative;
        width: 50%;
        padding: 10px 40px;
        box-sizing: border-box;
    }
    
    /* Common styles for all roadmap items */
    .roadmap-item .roadmap-marker {
        position: absolute;
        top: 20px;
        width: 12px;
        height: 12px;
        background-color: #007bff;
        border-radius: 50%;
        border: 2px solid #fff;
        z-index: 1;
    }
    
    .roadmap-item .roadmap-content {
        background-color: #f8f9fa;
        padding: 3px;
        border: 1px solid #ddd;
        border-radius: 8px;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
    }
    
    /* Left side styling */
    .roadmap-item.left {
        left: 0;
        text-align: left;
    }
    
    .roadmap-item.left .roadmap-marker {
        right: -6px; /* Position marker to the right */
    }
    
    .roadmap-item.left .roadmap-content {
        margin-right: 30px; /* Push content left */
    }
    
    /* Right side styling */
    .roadmap-item.right {
        left: 50%;
        text-align: left;
    }
    
    .roadmap-item.right .roadmap-marker {
        left: -6px; /* Position marker to the left */
    }
    
    .roadmap-item.right .roadmap-content {
        margin-left: 30px; /* Push content right */
    }
    
    /* Connecting line */
    .vertical-roadmap::before {
        content: '';
        position: absolute;
        top: 0;
        left: 50%;
        width: 2px;
        height: 100%;
        background-color: #007bff; /* Line color */
        z-index: 0;
    }
    .chart-container {
        width: 80%;
        margin: 30px auto;
        padding: 20px;
        border: 1px solid #ddd;
        border-radius: 8px;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
        background-color: #fff;
    }

</style>
{% endblock style %}
{% block content %}
<br>
<div class="container-fluid">
    <h4>HỒ SƠ NHÂN VIÊN</h4>
    <div class="row">
        <div class="col-3" style="border-radius:10px; border: solid gray 1px;margin-bottom:20px;">
            <br>
            {% if nhanvien["Giới tính"]=="Nam" %}
                <img style="width:100px;" class="card-img-top" src="static/img/undraw_profile.svg" alt="Card image cap">
            {% else %}
                <img style="width:100px;" class="card-img-top" src="static/img/undraw_profile_1.svg" alt="Card image cap">
            {% endif %}
            <hr/>
            <h3>Department: {{nhanvien["Department"]}}</h3>
            <div >
                <strong>Section code:</strong>
                <span class="check">{{nhanvien["Section code"]}}</span>
            </div>
            <div >
                <strong>Line:</strong> <span class="check">{{nhanvien["Line"]}}</span>
            </div>
            <div >
                <strong>Detail job title EN:</strong> <span class="check">{{nhanvien["Job title EN"]}}</span>
            </div>
            <div >
                <strong>Grade code:</strong> <span class="check">{{nhanvien["Gradecode"]}}</span>
            </div>
            <div >
                <strong>HC category:</strong> <span class="check">{{nhanvien["HC category"]}}</span>
            </div>
            <hr/>
            <div >
                <strong>Ngày sinh:</strong> <span class="ngay">{{nhanvien["Ngày sinh"]}}</span>
            </div>
            <div >
                <strong>Số điện thoại:</strong> <span class="check">{{nhanvien["Số điện thoại"]}}</span>
            </div>
            <div >
                <strong>Căn cước công dân:</strong> <span class="check">{{nhanvien["CCCD"]}}</span>
            </div>
            <div >
                <strong>Ngày cấp:</strong> <span class="ngay">{{nhanvien["Ngày cấp CCCD"]}}</span>
            </div>
            <div >
                <strong>Địa chỉ:</strong> <span class="ngay">{{nhanvien["Thường trú"]}}</span>
            </div>
            <hr/>
        </div>
        <div class="col" style="border-radius:10px; border: solid gray 1px;margin-top:20px;">
            <br>
            <h1 style="text-align:center;"> {{nhanvien["Họ tên"]}} 
                {% if nhanvien["Trạng thái"]=="Đang làm việc" %}
                <a class="btn btn-success">{{nhanvien["Trạng thái"]}}</a>
                {% elif nhanvien["Trạng thái"]=="Nghỉ thai sản" %}
                <a class="btn btn-warning">{{nhanvien["Trạng thái"]}}</a>
                {% else %}
                <a class="btn btn-danger">{{nhanvien["Trạng thái"]}}</a> <a class="btn btn-info">{{nhanvien["Ghi chú"]}}</a>
                {% endif %}
            </h1>
            <h3 style="text-align:center;"> {{nhanvien["Job title VN"]}}</h3>
            <hr/>
            <div class="vertical-roadmap">
                <div class="roadmap-item left">
                    <div class="roadmap-marker"></div>
                    <div class="roadmap-content">
                        <strong>Ngày vào:</strong> <span>{{nhanvien["Ngày vào"]}}</span>
                    </div>
                </div>
                <div class="roadmap-item right">
                    <div class="roadmap-marker"></div>
                    <div class="roadmap-content">
                        <strong>Ngày kí HĐ Thử việc:</strong> <span>{{nhanvien["Ngày kí HĐ Thử việc"]}}</span>
                    </div>
                </div>
                <div class="roadmap-item left">
                    <div class="roadmap-marker"></div>
                    <div class="roadmap-content">
                        <strong>Ngày hết hạn HĐ Thử việc:</strong> <span>{{nhanvien["Ngày hết hạn HĐ Thử việc"]}}</span>
                    </div>
                </div>
                <div class="roadmap-item right">
                    <div class="roadmap-marker"></div>
                    <div class="roadmap-content">
                        <strong>Ngày kí HĐ xác định thời hạn lần 1:</strong> <span>{{nhanvien["Ngày kí HĐ xác định thời hạn lần 1"]}}</span>
                    </div>
                </div>
                <div class="roadmap-item left">
                    <div class="roadmap-marker"></div>
                    <div class="roadmap-content">
                        <strong>Ngày hết hạn HĐ xác định thời hạn lần 1:</strong> <span>{{nhanvien["Ngày hết hạn HĐ xác định thời hạn lần 1"]}}</span>
                    </div>
                </div>
                <div class="roadmap-item right">
                    <div class="roadmap-marker"></div>
                    <div class="roadmap-content">
                        <strong>Ngày kí HĐ không thời hạn:</strong> <span>{{nhanvien["Ngày kí HĐ không thời hạn"]}}</span>
                    </div>
                </div>
                <div class="roadmap-item left">
                    <div class="roadmap-marker"></div>
                    <div class="roadmap-content">
                        <strong>Ngày nghỉ:</strong> <span>{{nhanvien["Ngày nghỉ"]}}</span>
                    </div>
                </div>
            </div>
            <hr/>
            <section id="chart-section" class="chart-container">
                <h2>Số ngày làm việc các tháng trong năm</h2>
                <label for="yearSelect">Chọn năm:</label>
                <select id="yearSelect">
                </select>
                <canvas id="workdaysChart" width="400" height="200"></canvas>
            </section>
        
            
        </div>
    </div>
</div>
<script>
    // Sample data for different years
    const yearlyData = {
        2023: [0, 0, 0, 0, 0, 0, 0, 22, 0, 0, 0, 0],
        2024: [0, 0, 0, 0, 0, 0, 0, 23, 0, 0, 0, 0]
        // Add more years and data as needed
    };

    const months = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];

    // Create chart
    const ctx = document.getElementById('workdaysChart').getContext('2d');
    let workdaysChart;

    function updateChart(year) {
        const data = yearlyData[year] || [];
        
        if (workdaysChart) {
            workdaysChart.destroy(); // Destroy existing chart instance
        }

        workdaysChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: months,
                datasets: [{
                    label: 'Số ngày làm việc',
                    data: data,
                    backgroundColor: 'rgba(0, 123, 255, 0.5)',
                    borderColor: 'rgba(0, 123, 255, 1)',
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                scales: {
                    y: {
                        beginAtZero: true,
                        title: {
                            display: true,
                            text: 'Số ngày làm việc'
                        }
                    },
                    x: {
                        title: {
                            display: true,
                            text: 'Tháng'
                        }
                    }
                },
                plugins: {
                    legend: {
                        display: true,
                        position: 'top'
                    },
                    tooltip: {
                        enabled: true
                    }
                }
            }
        });
    }

    // Populate year select options
    const yearSelect = document.getElementById('yearSelect');
    Object.keys(yearlyData).forEach(year => {
        const option = document.createElement('option');
        option.value = year;
        option.textContent = year;
        yearSelect.appendChild(option);
    });

    // Set initial chart
    updateChart(yearSelect.value);

    // Update chart on year change
    yearSelect.addEventListener('change', (event) => {
        updateChart(event.target.value);
    });
</script>
<script>
    function changeFormatDate(date){
        try{
            return date.split("-")[2] + "/" + date.split("-")[1] + "/" + date.split("-")[0];
        } catch {
            return "";    
    }}
    document.addEventListener('DOMContentLoaded', function() {
        var tds = document.querySelectorAll('check');
        tds.forEach(td => {
            if (td.textContent.trim() === 'None') {
                td.textContent = '';
            }
        });

        var ngays = document.querySelectorAll('.ngay');
        ngays.forEach(ngay => {
            if (ngay.textContent.trim() !== 'None' && ngay.textContent.includes('-')) {
                ngay.textContent = changeFormatDate(ngay.textContent);
            
            }
        });
    });
    
</script>
{% endblock content %}